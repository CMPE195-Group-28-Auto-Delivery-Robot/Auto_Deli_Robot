#include "NmeaGPSObject.h"



void NmeaGPSObject::RebootGPS(){
    switch (chipType)
    {
    case 1:
        ROS_INFO("Chip: MT3339");
        sendCommand("PMTK102");
        ros::Duration(3).sleep();
        ROS_INFO("Boot Complete");
        sendCommand("PMTK314,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0");
        sendCommand("PMTK220,100");
        break;

    case 2:
        ROS_INFO("Chip: UBlox");
        sendCommand("PUBX,41,1,0007,0003,38400,0");
        ros::Duration(5).sleep();
        sendCommand("PUBX,40,RMC,0,0,0,0,0,0");
        sendCommand("PUBX,40,GLL,0,0,0,0,0,0");
        sendCommand("PUBX,40,GSV,0,0,0,0,0,0");
        sendCommand("PUBX,40,VTG,0,0,0,0,0,0");
        sendCommand("PUBX,40,GSA,0,0,0,0,0,0");
        sendCommand("PUBX,40,ZDA,0,0,0,0,0,0");
        sendCommand(std::vector<uint8_t>{0xB5, 0x62, 0x06, 0x8A, 0x32, 0x00, 0x01, 0x02, 0x00, 0x00, 0x24, 0x00, 0x31, 0x10, 0x00, 0x25, 0x00, 
            0x31, 0x10, 0x01, 0x18, 0x00, 0x31, 0x10, 0x01, 0x21, 0x00, 0x11, 0x20, 0x04, 0x05, 0x00, 0x22, 0x20, 0x03, 0x01, 0x00, 0x21, 
            0x30, 0x64, 0x00, 0x07, 0x00, 0x91, 0x20, 0x01, 0x16, 0x00, 0x91, 0x20, 0x01, 0x1B, 0x00, 0x91, 0x20, 0x01, 0x8F, 0x6F});
        ros::Duration(1).sleep();
        sendCommand(std::vector<uint8_t>{0xB5, 0x62, 0x06, 0x8A, 0x32, 0x00, 0x01, 0x01, 0x00, 0x00, 0x24, 0x00, 0x31, 0x10, 0x00, 0x25, 0x00, 
            0x31, 0x10, 0x01, 0x18, 0x00, 0x31, 0x10, 0x01, 0x21, 0x00, 0x11, 0x20, 0x04, 0x05, 0x00, 0x22, 0x20, 0x03, 0x01, 0x00, 0x21, 
            0x30, 0x64, 0x00, 0x07, 0x00, 0x91, 0x20, 0x01, 0x16, 0x00, 0x91, 0x20, 0x01, 0x1B, 0x00, 0x91, 0x20, 0x01, 0x8E, 0x3E});
        ros::Duration(1).sleep();
        ROS_INFO("Boot Complete");
        break;
    
    default:
        ROS_INFO("Chip: Unknown");
        break;
    }
}

bool NmeaGPSObject::RebootGPS(robot_msgs::RebootGPS::Request &req,
                                robot_msgs::RebootGPS::Response &res){
    RebootGPS();
}